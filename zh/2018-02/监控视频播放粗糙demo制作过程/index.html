

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>楽圜</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon"/>
    
    <!-- stylesheets list from config.yml -->
    
    <link rel="stylesheet" href="/css/Mr.white.css">
    
    
</head>
<body>

<div id="content-outer">
    <div id="content-inner">
        <div class="post-container">
    <article id="post">
    <h1>监控视频播放粗糙demo制作过程
        <hr>
    </h1>
    <span class="date">2018-02-01</span>
    <div class="content markdown-body">
        <h2 id="PlayCtrl-dll"><a href="#PlayCtrl-dll" class="headerlink" title="PlayCtrl.dll"></a>PlayCtrl.dll</h2><ol>
<li>What is PlayCtrl.dll?<br>软解码库组件（windows），主要用于对实时码流数据进行解码显示（预览功能）和对录像文件进行<code>回放解码</code>等。</li>
<li>Why is PlayCtrl.dll?<br>项目需求：海康威视监控产品保存的录像格式需要特定的SDK才能解码播放。</li>
<li>How to use?<br><code>Attention</code>本段内容仅关注录像播放，无任何复杂功能。</li>
</ol>
<h3 id="step1：封装API"><a href="#step1：封装API" class="headerlink" title="step1：封装API"></a>step1：封装API</h3><p>官方提供了C++的动态链接库(Dynamic-Link Library)，第一步就是用C#类来封装其中的方法，以供用户使用。</p>
<blockquote>
<p>A dynamic-link library (DLL) is a module that contains functions and data that can be used by another module (application or DLL).<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682589(v=vs.85" target="_blank" rel="external">[see more]</a>.aspx)</p>
</blockquote>
<p>基本用法如下：<br>    c++ 头文件中的定义：<br>    NPD_API int   NP_Init();<br>    C#中定义函数<br>    [DllImport(“npd_api.dll”)]<br>    public static extern int NP_Init();<br><a href="http://www.cnblogs.com/wdysunflower/archive/2010/09/01/1813947.html" target="_blank" rel="external">[see more:前辈经验]</a><br><a href="http://www.cnblogs.com/dashouqianxiaoshou/p/3953312.html" target="_blank" rel="external">[使用实例1-胡双挺]</a><br><a href="http://www.cnblogs.com/over140/archive/2010/03/12/1683973.html" target="_blank" rel="external">[使用实例2-农民伯伯]</a></p>
<h3 id="step2：简单粗糙的界面"><a href="#step2：简单粗糙的界面" class="headerlink" title="step2：简单粗糙的界面"></a>step2：简单粗糙的界面</h3><p>只是为了测试播放，所以界面简单而粗糙。我在Winform和WPF中分别尝试了一下：</p>
<ul>
<li><p>###Winform<br>pictureBox + openFileDialog + button<br><img src="http://ww2.sinaimg.cn/large/0063MPrKjw1erua6gzu2ej308f08ezkk.jpg" alt="如图"></p>
</li>
<li><p>###WPF<br>在这里遇到了两个问题：</p>
<ul>
<li><a href="http://bbs.csdn.net/topics/390363911" target="_blank" rel="external">WPF中获得句柄问题</a></li>
<li><a href="http://q.cnblogs.com/q/45220/" target="_blank" rel="external">AllowsTransparency与win32控件冲突</a>、<a href="https://social.msdn.microsoft.com/Forums/zh-CN/60be586b-f7c1-4191-a578-756bc6707977/wpfdirectshow?forum=wpfzhchs" target="_blank" rel="external">关于WPF用DirectShow做视频播放问题</a>、<a href="https://social.msdn.microsoft.com/Forums/zh-CN/3ac7f98c-e128-4c84-9138-e5d8d51904fc/how-to-avoid-airspace-problem-wpf-with-winforms-control?forum=wpf" target="_blank" rel="external">How to avoid Airspace problem</a>、<a href="http://blog.csdn.net/yangyy9611/article/details/17464133" target="_blank" rel="external">WPF下YUV播放的D3D解决方案</a></li>
</ul>
</li>
</ul>
<p>界面代码请自行百度：wpf picturebox</p>
<h3 id="step3：两行代码搞定播放"><a href="#step3：两行代码搞定播放" class="headerlink" title="step3：两行代码搞定播放"></a>step3：两行代码搞定播放</h3><p><code>PlayM4_OpenFile()</code>、<code>PlayM4_Play()</code></p>

    </div>
    
    <br/>
    <hr>
    <div class="copyright">
    本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎4.0 国际许可协议</a>进行许可。 <br>
    <a style="margin-top:20px;border-bottom: none" rel="license"
       href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img
                alt="知识共享许可协议" style="border-width:0"
                src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png"/></a>
</div>
    
</article>
    <hr>
    <nav id="pagination" class="menu">
    
    <a href="/zh/2018-02/html5简单视频播放功能实现/" title="html5简单视频播放功能实现" class="prev">&larr; next</a>
    

    <!-- 导航模块 -->

<nav id="menu">
    <a href="/" class="">Home</a>
    <a href="/archives" class="">Archives</a>
    <a href="/about" class="">About</a>
</nav>

    
    <a href="/zh/2018-02/2018.1月工作/" title="1月" class="next">prev &rarr;</a>
    
</nav>
    <!-- 声明模块 -->
<P class="declaration">
    Copyright © 2016 by
    <a href="/about">Jane w. Gu</a>,&nbsp;&nbsp;Powered by
    <a href="http://hexo.io/" target="_blank">Hexo</a>,&nbsp;&nbsp;Theme inspired by
    <a href="https://github.com/geekplux/hexo-theme-typing" target="_blank">typing</a>
</P>
</div>
    </div>
</div>


<!-- scripts list from theme config.yml -->

<script src="/js/Mr.white.js"></script>



</body>
</html>
